<app-header [appTitle]="appTitle(viewDate)"></app-header>

<app-body [breadCrumbTree]="breadCrumbTree" [show]="!loaderFullScreen">
  <advanced-filter>
    <comercial-templates-filtro-vendedor-escritorio-date [profile]="profile" [showAll]="false"
      (formValue)="dataFilter($event)">
    </comercial-templates-filtro-vendedor-escritorio-date>
  </advanced-filter>

  <div class="row">
    <div class="col-md-6">
      <div class="embed-responsive embed-responsive-16by9">
        <agm-map [latitude]="latitud" [longitude]="longitud" [zoom]="13" class="embed-responsive-item"
          (mapClick)="actualizarMarcador($event)">

          <agm-marker *ngFor="let mapa of mapas" [latitude]="mapa.LATITUD" [longitude]="mapa.LONGITUD"
            [iconUrl]="mapa.markers.icon" (markerDragEnd)="actualizarDireccion($event)"
            (markerClick)="onMarkerClick(mapa)">
            <agm-info-window *ngIf="selectedMarker === mapa" [disableAutoPan]="true">
              <div class="marker-info-window">
                <h5 class="marker-name">{{ mapa.NOMBRE }}</h5>
                <p class="marker-info"><strong>Direcci√≥n:</strong> {{ mapa.DIRECCION }}</p>
                <p class="marker-info"><strong>Fecha de inicio:</strong> {{ mapa.FECHA_INICIO | date:'dd/MM/yyyy
                  HH:mm:ss' }}</p>
                <p class="marker-info"><strong>Fecha de fin:</strong> {{ mapa.FECHA_FIN | date:'dd/MM/yyyy HH:mm:ss' }}
                </p>

                <button class="marker-button" (click)="agregarClienteTemporal(mapa)">
                  <i class="fas fa-plus"></i> &nbsp; Agregar
                </button>
              </div>
            </agm-info-window>
          </agm-marker>
        </agm-map>

        <div id="map-zoom-control" class="map-control"></div>
      </div>
    </div>

    <div class="col-md-6">
      <h6 class="text-center">Asignar visitas a promotores</h6>
      <div class="table-responsive">

        <custom-table [config]="tableConfigAtividades">
          <ng-template #thead let-thead>
            <tr>
              <th class="text-center">Cod. cliente</th>
              <th class="text-center">Nombre</th>
              <th class="text-center">Fecha visita</th>
              <th class="text-center">Promotor</th>
              <th class="text-center">Opciones</th>


            </tr>
          </ng-template>
          <ng-template #tbody let-tbody>
            <tr *ngFor="let item of atividades">
              <td class="hover text-center" style="width: 35%" (click)="item.checked = !item.checked">
                <span *ngIf="item.codigoCliente">{{ item.codigoCliente }}</span>
                <span *ngIf="!item.codigoCliente">N/A</span>
              </td>
              <td class="hover text-center" style="width: 35%" (click)="item.checked = !item.checked">
                <span *ngIf="item.nombre">{{ item.nombre }}</span>
                <span *ngIf="!item.nombre">N/A</span>
              </td>
              <td class="hover text-center" style="width: 35%" (click)="item.checked = !item.checked">
                <input type="datetime-local" class="form-control">

              </td>

              <td class="hover text-center" style="width: 35%" (click)="item.checked = !item.checked">
                <ng-select [searchable]="true" [clearable]="false" [items]="filteredVendedores" [virtualScroll]="true"
                  labelForId="vendedor" bindLabel="nome" bindValue="id" (change)="filtrarClientes()"
                  formControlName="vendedor_id"></ng-select>
              </td>
              <td>
                
              </td>

            </tr>
          </ng-template>
        </custom-table>
      </div><br>
      <div align="center">
        <button class="btn btn-success"> Agendar </button>
      </div>
    </div>

  </div>
</app-body>