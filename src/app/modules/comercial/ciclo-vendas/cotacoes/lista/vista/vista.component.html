<div class="modal-content custom-modal" id="contentToConvert">
  <form [formGroup]="myForm" (ngSubmit)="onSubmit()">
    <div #contentToConvert>
      <div class="wrapper card-bodyy">
        <!-- Main content -->
        <section class="invoice">
          <!-- title row -->
          <div class="row">
            <div class="col-12">
              <h2 class="page-header">
                <img
                  [src]="imageSrc"
                  alt="Logo"
                  [style.width.px]="imageWidth"
                  [style.height.px]="imageHeight"
                />
                <small class="float-right"
                  >Nº Oferta: {{ resultFromParent.oferta[0].codigo_oferta }}</small
                >
              </h2>
            </div>
            <!-- /.col -->
          </div>
          <!-- info row -->
          <div class="row invoice-info">
            <div class="col-md-12">
              <div class="row">
                <div class="col-md-12">
                  <div class="card wider-card">
                    <div class="card-header">
                      <h5>DATOS DE OFERTA</h5>
                    </div>
                    <div class="card-body">
                      <div class="col-md-12">
                        <div class="row">
                          <div class="col-md-3">
                            <label for="">Fecha Inicial:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{
                                resultFromParent.oferta[0].fecha_inicial
                              }}"
                              class="form-control"
                              readonly
                            />
                          </div>
                          <div class="col-md-3">
                            <label for="">Fecha final:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{
                                resultFromParent.oferta[0].fecha_final
                              }}"
                              class="form-control"
                              readonly
                            />
                          </div>
                          <div class="col-md-3">
                            <label for="">Fecha de Creación:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{
                                resultFromParent.oferta[0].fecha_creacion
                              }}"
                              class="form-control"
                              readonly
                            />
                          </div>
                          <div class="col-md-3">
                            <label for="">Monto total Bruto:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{
                                resultFromParent.oferta[0].monto_total_bruto
                              }}"
                              class="form-control"
                              readonly
                            />
                          </div>
                          <div class="col-md-3">
                            <label for="">Monto Total:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{
                                resultFromParent.oferta[0].monto_total
                              }}"
                              class="form-control"
                              readonly
                            />
                          </div>
                          <div class="col-md-3">
                            <label for="">Descuento Total:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{
                                resultFromParent.oferta[0].descuento_total
                              }}"
                              class="form-control"
                              readonly
                            />
                          </div>
                          <div class="col-md-3">
                            <label for="">Observación:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{
                                resultFromParent.oferta[0].observacion
                              }}"
                              class="form-control"
                              readonly
                            />
                          </div>
                          <div class="col-md-3">
                            <label for="">Peso Total:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{
                                resultFromParent.oferta[0].peso_total
                              }}"
                              class="form-control"
                              readonly
                            />
                          </div>
                          <div class="col-md-3">
                            <label for="">Modo de entrega:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{
                                resultFromParent.oferta[0].nombre_modo_entrega
                              }}"
                              class="form-control"
                              readonly
                            />
                          </div>
                          <div
                            class="col-md-3"
                            *ngIf="
                              resultFromParent.oferta[0].descripcion !==
                                undefined &&
                              resultFromParent.oferta[0].descripcion !== null
                            "
                          >
                            <label for="">Motivo de Cierre:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{
                                resultFromParent.oferta[0].descripcion
                              }}"
                              class="form-control"
                              readonly
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-12">
              <div class="row">
                <div class="col-md-12">
                  <div class="cardwider-card">
                    <div class="card-header">
                      <h5>DATOS DEL CLIENTE</h5>
                    </div>
                    <div class="card-body">
                      <div class="col-md-12">
                        <div class="row">
                          <div class="col-md-3">
                            <label for="">Codigo del cliente:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{
                                resultFromParent.oferta[0].codigo_cliente
                              }}"
                              class="form-control"
                              readonly
                            />
                          </div>
                          <div class="col-md-6">
                            <label for="">Nombre del cliente:</label>
                            <input
                                type="text"
                                name=""
                                id="cliente"
                                value="{{
                                    resultFromParent.oferta[0].nombre_cliente
                                }}"
                                class="form-control"
                                readonly
                            />
                          </div>
                        </div>
                        <br>
                        <div class="row">
                          <div class="col-md-4">
                            <label for="">Celular:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{
                                resultFromParent.oferta[0].celular_clie
                              }}"
                              class="form-control"
                              readonly
                            />
                          </div>
                          <div class="col-md-4">
                            <label for="">E-mail:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{ resultFromParent.oferta[0].e_mail }}"
                              class="form-control"
                              readonly
                            />
                          </div>
                          <div class="col-md-4">
                            <label for="">Contacto del cliente:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{
                                resultFromParent.oferta[0].nombre_cont
                              }}"
                              class="form-control multiline-input"
                              readonly
                            />
                          </div>  
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-12">
              <div class="row">
                <div class="col-md-12">
                  <div class="card wider-card">
                    <div class="card-header">
                      <h5>DATOS DEL VENDEDOR</h5>
                    </div>
                    <div class="card-body">
                      <div class="col-md-12">
                        <div class="row">
                          <div class="col-md-3">
                            <label for="">Nombre vendedor:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{
                                resultFromParent.oferta[0].nombre_vendedor
                              }}"
                              class="form-control multiline-input"
                              readonly
                            />
                          </div>
                          <div class="col-md-3">
                            <label for="">Nombre lista:</label>
                            <input
                              type="text"
                              name=""
                              id=""
                              value="{{
                                resultFromParent.oferta[0].nombre_lista
                              }}"
                              class="form-control"
                              readonly
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <ng-container *ngIf="resultFromParent.oferta[0].gestor !== '' && resultFromParent.oferta[0].gestor !== null">
                    <div class="card wider-card">
                      <div class="card-header">
                        <h5>DATOS DE AUTORIZACION</h5>
                      </div>
                      <div class="card-body">
                        <div class="col-md-12">
                          <div class="row">
                            <div class="col-md-3">
                              <label for="autorizador">Autorizador:</label>
                              <input
                                type="text"
                                id="autorizador"
                                [value]="resultFromParent.oferta[0].gestor"
                                class="form-control"
                                readonly
                              />
                            </div>
                            <div class="col-md-3">
                              <label for="fechaGestion">Fecha de Gestion:</label>
                              <input
                                type="text"
                                id="fechaGestion"
                                [value]="resultFromParent.oferta[0].fecha_gestion"
                                class="form-control"
                                readonly
                              />
                            </div>
                            <div class="col-md-3">
                              <label for="obsSolicitante">Observacion Solicitante:</label>
                              <input
                                type="text"
                                id="obsSolicitante"
                                [value]="resultFromParent.oferta[0].obs_solicitante"
                                class="form-control"
                                readonly
                              />
                            </div>
                            <div class="col-md-3">
                              <label for="obsGestor">Observacion Gestor:</label>
                              <input
                                type="text"
                                id="obsGestor"
                                [value]="resultFromParent.oferta[0].obs_gestor"
                                class="form-control"
                                readonly
                              />
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </ng-container>
                  
                </div>
              </div>
            </div>
            <!-- /.col -->
          </div>
          <!-- Table row -->
          <div class="row">
            <div class="col-12">
              <div class="card wider-card">
                <div class="card-header">
                  <h5>DETALLE</h5>
                </div>
                <div class="card-body table-container" >
                  <table class="table table-striped">
                    <thead>
                      <tr>
                        <th class="text-center">CODIGO MATERIAL</th>
                        <th class="text-center">NOMBRE MATERIAL</th>
                        <th class="text-center">UNIDAD</th>
                        <th class="text-center">PRECIO</th>
                        <th class="text-center">CANTIDAD</th>
                        <th class="text-center">TOTAL BRUTO</th>
                        <th class="text-center">PRECIO DESCUENTO</th>
                        <th class="text-center">SUBTOTAL</th>
                        <th class="text-center">NOMBRE ALMACEN</th>
                        
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let analitico of analiticos; let i = index">
                        <td class="text-center">
                          {{ analitico.codigo_material }}
                        </td>
                        <td class="text-center">
                          {{ analitico.nombre_material }}
                        </td>
                        <td class="text-center">{{ analitico.unidad }}</td>
                        <td class="text-center">
                          {{ analitico.precio.toFixed(2) }}
                        </td>
                        <td class="text-center">
                          {{ analitico.cantidad.toFixed(2) }}
                        </td>
                        <td class="text-center">{{ analitico.total_bruto }}</td>
                        <td class="text-center">
                          <ng-container *ngIf="analitico.precio_descuento !== null && analitico.precio_descuento !== undefined">
                            {{ analitico.precio_descuento + '%' }}
                          </ng-container>
                        </td>
                        
                        <td class="text-center">{{ analitico.subtotal }}</td>
                        <td class="text-center">
                          {{ analitico.nombre_almacen }}
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  <div class="col-md-3">
                    <label for="">Monto total Bruto:</label>
                    <input
                      type="text"
                      name=""
                      id=""
                      value="{{ resultFromParent.oferta[0].monto_total_bruto }}"
                      class="form-control"
                      readonly
                    />
                  </div>
                  <div class="col-md-3">
                    <label for="">Monto Total:</label>
                    <input
                      type="text"
                      name=""
                      id=""
                      value="{{ resultFromParent.oferta[0].monto_total }}"
                      class="form-control"
                      readonly
                    />
                  </div>
                </div>
              </div>
            </div>
            <!-- /.col -->
          </div>
          <!-- /.row -->
          <div class="row" *ngIf="showDescripcionCard">
            <div class="col-12">
              <div class="card wider-card">
                <div class="card-header">
                  <h5>CIERRE DE OFERTA</h5>
                </div>
                <div class="card-body table-container">
                  <span>
                    Es necesario rellenar los campos con <span class="text-danger" >* </span> 
                  </span>
                  <div class="col-md-6">
                    <label for="">MOTIVO DE CIERRE <span class="text-danger">*</span></label><i
                    class="far fa-question-circle p-2"
                    tooltip="Seleccione un motivo de cierre de la lista."
                    placement="right">
                  </i>
                    <select class="form-control" formControlName="estadoOfert">
                      <option value="" disabled selected>Selecciona...</option>
                      <option
                        *ngFor="let item of cierre_oferta"
                        [value]="item.id"
                      >
                        {{ item.descripcion }}
                      </option>
                    </select>
                  </div>

                  <div class="col-md-6">
                    <label for="">Observación <span class="text-danger">*</span></label>
                    <i
                      class="far fa-question-circle p-2"
                      tooltip="Coloque su justificacion de por que se cerro la oferta."
                      placement="right">
                    </i>
                    <input
                      type="text"
                      formControlName="descripcion"
                      class="form-control mt-2"
                      id="description"
                      [value]="item?.descripcion"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <!-- /.content -->
      </div>
    </div>
    <div class="modal-footer">
      <a
        class="btn btn-danger"
        *ngIf="showCierreButton"
        (click)="toggleDescripcionCard()"
        >CIERRE OFERTA</a
      >
      <button type="submit" class="btn btn-success" *ngIf="showGuardarButton" [disabled]="isLoading">
        GUARDAR
      </button>
      
      <a
        type="button"
        class="btn btn-secondary"
        #captureButton
        (click)="onDownloadPDF()"
        >DESCARGAR</a
      >
      <a type="button" class="btn btn-secondary" (click)="captureScreen()"
        >IMPRIMIR</a
      >
    </div>
  </form>
</div>
